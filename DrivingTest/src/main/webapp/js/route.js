define("jkbd!app/route",["jkbd-sdk!app/public","jkbd-sdk!data/constant","jkbd-sdk!core/Citycore"],function(t,e,i){"use strict";var a=this.Simple,n=a.Core.Store,r=a.UserApi,o=a.AuthApi,s=function(t,e,n){n&&(c(t,e,n),d(e));var r=e.$page;(!e.$page||i.codeMaps[r]||i.pinyinMaps[r])&&(r="home"),"mnks"===e.$page?a.Create("jkbd-app!app/route/init",t,e,n):-1===["download","zt"].indexOf(r)&&("my"===r&&(r="user"),a.Create("jkbd!app/home/"+r+"/main",t,e,n))},c=function(t,e,i){$("img").removeAttr("alt").removeAttr("title");{var o=$(a.Container);r.userInfo}if(i){var s=["%c\u6b22\u8fce\u52a0\u5165\u9a7e\u8003\u5b9d\u5178\u524d\u7aef\u56e2\u961f\uff0c\u6211\u4eec\u4e00\u8d77\u521b\u9020\u9177\u70ab\u9a7e\u8003\u5b9d\u5178",'\u8bf7\u53d1\u7b80\u5386\u81f3 hr@mucang.cn (\u90ae\u4ef6\u6807\u9898\u683c\u5f0f\uff1a"\u59d3\u540d-\u624b\u673a\u53f7-\u6765\u81eaconsole")'];console.log(s.join("\n"),"color:#1dacf9;text-shadow:0 0 2px rgba(29,172,249,.5);")}r.init(e),o.item("jindu-inner-bar").css("width","100%");var c=o.find("[data-playcount]");if(c.length){var d=[];c.each(function(){d.push($(this).data("playcount"))});var l=function(t){var e=parseInt(t/1e3);return e>10?e/10+"\u4e07":t};n(["jkbd-sdk!news/articlesViewCount?articleIdList="+d.join(",")]).request(function(t){var e=t.data;c.each(function(){var t=$(this).html().replace("***",l(e[$(this).data("playcount")]));$(this).html(t)})})}var u=a.Module.jkbd.DOM.article;f(u);var h=1;if((parseInt(r.userInfo.vary)&h)!==h&&m(e),$(".login-span").click(function(){_hmt.push(["_trackEvent","\u8d26\u53f7\u64cd\u4f5c","\u5f39\u8d77\u767b\u5f55\u754c\u9762"])}),$("[data-action=reg]").click(function(){_hmt.push(["_trackEvent","\u8d26\u53f7\u64cd\u4f5c","\u5f39\u8d77\u6ce8\u518c\u754c\u9762"])}),a.AuthApi.User.authToken&&_hmt.push(["_trackEvent","\u8d26\u53f7\u8bbf\u95ee","\u5df2\u767b\u5f55\u7528\u6237\u8bbf\u95ee"]),window.localStorage)try{if(!window.localStorage.getItem("jkbd_showTipsSync"))return;window.localStorage.removeItem("jkbd_showTipsSync");var p=2;(parseInt(r.userInfo.vary)&p)!==p&&a.Create("jkbd!app/others/tipsSync",!0)}catch(v){}},d=function(){var t=$(a.Container),e=t.item("main-carchoose-container");1==e.attr("data-bind")&&e.on("click","a",function(){var t=$(this).attr("data-car");$(this).hasClass("current")||(r.setUserInfo({carType:t}),window.location=window.location.href.replace(/&?(from|at|cartype|daihao|course|citycode|citypinyin)=[^#&]+/gi,""))});var i=t.item("seach-container");if(i.length){var n=i.item("type-list"),o=i.item("type");i.item("type-select").mouseenter(function(){n.slideDown(100),o.addClass("xx-show")}).mouseleave(function(){n.slideUp(100),o.removeClass("xx-show")}),n.on("click","li",function(){n.hide(),o.html($(this).html()),i.item("stype").val($(this).attr("data-stype")),i.item("stype")[0].value=$(this).attr("data-stype")})}$(".head_nav .nav").on("mouseenter","li",function(){var t=$(this).attr("data-item"),e=$(this).parent();e.find(".current").removeClass("current"),$(this).addClass("current");var i=e.parent().next();i.find(".current").removeClass("current"),i.item(t+"-content").addClass("current")});var s=a.Module.jkbd.DOM.hook;s.item("toTop").click(function(){$("html,body").animate({scrollTop:0},300)}),s.item("close").click(function(){s.fadeOut()});var c=a.Module.jkbd.DOM.footer;c.length>0&&c.item("feedback").click(function(){a.Create("jkbd!app/home/feedback/dialogAlert")});var d=c.item("fotter1-header-ul"),h=c.item("fotter-ul");if(d.on("mouseenter","li",function(){d.find(".current").removeClass("current"),$(this).addClass("current");var t=$(this).index();h.hide(),h.eq(t).show()}),window.browser.ie&&window.browser.version<=6){var f=$(window).height();s.css("top",f-190),$(window).scroll(function(){s.css("top",$(window).scrollTop()+f-190)}),l()}$(".page-bbs").on("click",".fun-show-erweima",function(){var t=$(this).attr("data-t")||1;a.Require(["jkbd!widgets/Dialog"],function(e){e({title:!1,content:"<div class='bbs-show-erweima ma"+t+"'><i class='bbs-show-erweima-x' title='\u5173\u95ed'></i></div>",width:420,backdrop:!0,closeBtn:!1,className:"transparent bbs-need-login",renderAfter:function(t){var e=this;t.find(".bbs-show-erweima-x").click(function(){e.close()})}})})}),$(document.body).on("click","[data-action]",u)},l=function(t){t=t||a.Container,window.browser.ie&&window.browser.version<=6&&t.find("[data-hover]").each(function(){var t=$(this);if(!t.data("hover1")){t.data("hover1",1);var e=t.attr("data-hover");t.hover(function(){t.item(e).show()},function(){t.item(e).hide()})}})},u=function(){var t=$(this),e=t.data("action");if("login"===e){if(a.AuthApi.User.userInfo)return;a.Create("jkbd!app/home/member/showLogin")}else{if("login_refresh"===e){if(a.AuthApi.User.userInfo)return;return a.Create("jkbd!app/home/member/showLogin",function(){window.location.reload()}),!1}if("logout"===e){if($(this).hasClass("disable"))return;return $(this).html("\u9000\u51fa\u4e2d...").addClass("disable"),o.User.logout().then(function(){window.location.reload()}),!1}if("login_url"===e){if(!o.User.authToken){var i=$(this).attr("href");return a.Create("jkbd!app/home/member/showLogin",function(){window.location=i}),!1}}else if("tips_sync"===e)return o.User.authToken?a.Create("jkbd!app/others/tipsSync"):a.Create("jkbd!app/home/member/showLogin",function(){window.location.reload()}),!1}},h=function(t,e){var i=a.Module.jkbd.DOM.article.item("breadcrumb-label-container");i.empty();for(var n="",r=e?" data-pjax":"",o=0;o<t.length-1;o++){var s=t[o];n+="<a "+r+" href='"+s[1]+"'>"+s[0]+"</a>",n+="<span class='gap'>&gt;</span>"}t.length>0&&(n+="<a class='mylink'>"+t[t.length-1]+"</a>"),i.html(n)},f=function(t){var e=a.Module.jkbd.DOM.article;t=t||e,t.find("img").each(function(){var t=$(this).attr("data-src"),e=$(this).attr("src");if(!e&&t){var i=$(this).attr("data-size");i&&t.match(/image\.cms\.jiaxiaozhijia\.com/i)&&(t=t.replace(/!.+$/,"!"+i)),$(this).attr("src",t)}})},p=function(){var t=$(window),e=$(document.body).item("jkbd-main-header-nav");t.scroll(function(){var t=$(this).scrollTop();e.css(t>42?{position:"fixed",top:0}:{position:"relative",top:-70})})},m=function(t){var e=$(a.Container);if("member"!==t.$page){var i=1|parseInt(r.userInfo.vary);if("city"===t.$page||"/mnks/exam"===t.$path)r.setUserInfo({vary:i});else{var n=e.item("header-cityinfo").width(),o=$(window).width(),s=(o-1200)/2-10,c=s+n+10;e.append('<div class="tikuguide-container" data-item="tikuguide-container"><div class="bwapper"><div class="bg-dian"></div></div><div class="bg-s"><div class="l" style="width:'+s+'px;"></div><div class="r" style="left:'+c+'px"></div></div></div>'),setTimeout(function(){e.item("tikuguide-container").addClass("moving")},250),e.item("tikuguide-container").find(".bg-dian").click(function(){e.item("tikuguide-container").fadeOut(),$(window).unbind("mousewheel",d),r.setUserInfo({vary:i})});var d=function(t){return t.preventDefault(),!1};$(window).bind("mousewheel",d)}}};return{init:s,setBread:h,bindHoverEvents:l,replaceImgsrc:f,fixedNav:p}});